{"ast":null,"code":"import _regeneratorRuntime from\"/Users/likemdunyo/Desktop/Gameli/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/likemdunyo/Desktop/Gameli/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/likemdunyo/Desktop/Gameli/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useReducer,createContext}from'react';import AppReducer from'./AppReducer';import axios from'axios';var initialState={transactions:[],username:'',password:'',userId:'',error:null,loading:true};// create context\nexport var GlobalContext=createContext(initialState);// provider \nexport var GlobalProvider=function GlobalProvider(_ref){var children=_ref.children;var _useReducer=useReducer(AppReducer,initialState),_useReducer2=_slicedToArray(_useReducer,2),state=_useReducer2[0],dispatch=_useReducer2[1];function getTxns(){return _getTxns.apply(this,arguments);}function _getTxns(){_getTxns=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axios.get(\"/api/v1/txns\");case 3:res=_context.sent;dispatch({type:'GET_TXNS',payload:res.data.data});_context.next=10;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](0);dispatch({type:'GET_ERR',payload:console.log(_context.t0)});case 10:case\"end\":return _context.stop();}}},_callee,null,[[0,7]]);}));return _getTxns.apply(this,arguments);}function deleteTransaction(_x){return _deleteTransaction.apply(this,arguments);}function _deleteTransaction(){_deleteTransaction=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(id){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return axios.delete(\"/api/v1/txns/\".concat(id));case 3:dispatch({type:'DELETE_TXN',payload:id});_context2.next=9;break;case 6:_context2.prev=6;_context2.t0=_context2[\"catch\"](0);dispatch({type:'GET_ERR',payload:console.log(_context2.t0)});case 9:case\"end\":return _context2.stop();}}},_callee2,null,[[0,6]]);}));return _deleteTransaction.apply(this,arguments);}function addTransaction(_x2){return _addTransaction.apply(this,arguments);}function _addTransaction(){_addTransaction=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(transaction){var config,res;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:config={headers:{\"Content-Type\":\"application/json\"}};_context3.prev=1;_context3.next=4;return axios.post(\"/api/v1/txns\",transaction,config);case 4:res=_context3.sent;dispatch({type:'ADD_TXN',payload:res.data.data});console.log(res);_context3.next=12;break;case 9:_context3.prev=9;_context3.t0=_context3[\"catch\"](1);dispatch({type:'GET_ERR',payload:console.log(_context3.t0)});case 12:case\"end\":return _context3.stop();}}},_callee3,null,[[1,9]]);}));return _addTransaction.apply(this,arguments);}function login(_x3){return _login.apply(this,arguments);}function _login(){_login=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(data){var res;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.prev=0;_context4.next=3;return axios.post('api/v1/users/login',data);case 3:res=_context4.sent;console.log(res);//const currentUser = res.data.data.filter(item=> item.username === username)[0]\ndispatch({type:'LOGIN',payload:res.data.data});console.log(state);_context4.next=12;break;case 9:_context4.prev=9;_context4.t0=_context4[\"catch\"](0);dispatch({type:'GET_ERR',payload:console.log(_context4.t0)});case 12:case\"end\":return _context4.stop();}}},_callee4,null,[[0,9]]);}));return _login.apply(this,arguments);}function register(_x4){return _register.apply(this,arguments);}function _register(){_register=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(data){var res;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:if(!data){_context5.next=10;break;}_context5.prev=1;_context5.next=4;return axios.post('api/v1/users/register',data);case 4:res=_context5.sent;_context5.next=10;break;case 7:_context5.prev=7;_context5.t0=_context5[\"catch\"](1);console.log(_context5.t0);case 10:case\"end\":return _context5.stop();}}},_callee5,null,[[1,7]]);}));return _register.apply(this,arguments);}return/*#__PURE__*/React.createElement(GlobalContext.Provider,{value:{transactions:state.transactions,error:state.error,loading:state.loading,userId:state.userId,username:state.username,deleteTransaction:deleteTransaction,addTransaction:addTransaction,getTxns:getTxns,login:login,register:register}},children);};export default GlobalProvider;","map":{"version":3,"sources":["/Users/likemdunyo/Desktop/Gameli/client/src/context/GlobalState.js"],"names":["React","useReducer","createContext","AppReducer","axios","initialState","transactions","username","password","userId","error","loading","GlobalContext","GlobalProvider","children","state","dispatch","getTxns","get","res","type","payload","data","console","log","deleteTransaction","id","delete","addTransaction","transaction","config","headers","post","login","register"],"mappings":"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","sourcesContent":["import React , { useReducer, createContext } from 'react';\nimport AppReducer from './AppReducer';\nimport axios from 'axios';\n\nconst initialState = {\n    transactions: [],\n    username: '',\n    password: '',\n    userId: '',\n    error: null,\n    loading: true\n};\n// create context\nexport const GlobalContext = createContext(initialState);\n\n// provider \nexport const GlobalProvider = ({ children }) => {\n    const [state , dispatch ] = useReducer( AppReducer , initialState);\n\n    async function getTxns(){\n            try {\n                const res = await axios.get(`/api/v1/txns`);\n                dispatch({\n                    type: 'GET_TXNS',\n                    payload: res.data.data\n                });\n            } catch (err) {\n                dispatch({\n                    type: 'GET_ERR',\n                    payload: console.log(err)\n                });\n            }\n        \n    }\n\n    async function deleteTransaction(id){\n            try {\n                await axios.delete(`/api/v1/txns/${id}`);\n                dispatch({\n                    type: 'DELETE_TXN',\n                    payload: id\n                });\n                \n            } catch (err) {\n                dispatch({\n                    type: 'GET_ERR',\n                    payload: console.log(err)\n                });\n            }\n    }\n\n    async function addTransaction(transaction){\n        const config = {\n            headers:{\n                \"Content-Type\":\"application/json\"\n            }\n        }\n            try {\n                const res = await axios.post(`/api/v1/txns`, transaction, config);\n                dispatch({\n                    type: 'ADD_TXN',\n                    payload: res.data.data\n                });\n                console.log(res)\n            } catch (err) {\n                dispatch({\n                    type: 'GET_ERR',\n                    payload: console.log(err)\n                });\n                \n            }\n    }\n\n    async function login(data){\n        try {\n            const res = await axios.post('api/v1/users/login' , data)\n            console.log(res);\n            //const currentUser = res.data.data.filter(item=> item.username === username)[0]\n            dispatch({\n                type: 'LOGIN',\n                payload: res.data.data\n            })\n            console.log(state);\n        } catch (error) {\n            dispatch({\n                type: 'GET_ERR',\n                payload: console.log(error)\n            })\n        }\n    }\n\n    async function register(data){\n        if(data){\n            try {\n                const res = await axios.post('api/v1/users/register', data);\n            } catch (error) {\n                console.log(error)\n            }\n        }\n    }\n\n    return (\n        <GlobalContext.Provider value={{\n            transactions: state.transactions,\n            error: state.error,\n            loading: state.loading,\n            userId: state.userId,\n            username: state.username,\n            deleteTransaction,\n            addTransaction,\n            getTxns,\n            login,\n            register\n            }}>\n            {children}\n        </GlobalContext.Provider>\n    )\n}\nexport default GlobalProvider;"]},"metadata":{},"sourceType":"module"}